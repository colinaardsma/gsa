{% extends "base.html" %}
{% block content %}
{% load projection_filters %}
{% load tz %}
<div>
    <h2>Helpful Links</h2>
    <a href="/admin" class="btn btn-outline-primary btn-sm">Admin Console</a>
    <br/>
    {% if not request.user.profile.access_token %}
    <a href="{{yahoo_link}}" class="btn btn-outline-primary btn-sm">Link Yahoo! Account</a>
    {% endif %}
    <a href="/get_leagues" class="btn btn-outline-primary btn-sm">
        {% if not request.user.profile.leagues %}
        Get Yahoo! Leagues
        {% else %}
        Update Yahoo! Leagues
        {% endif %}
    </a>
    <br/>
    <a href="https://baseball.fantasysports.yahoo.com/league/{{main_league.league_name|lower_and_remove_spaces}}/{{main_league.season}}" target="_blank" class="btn btn-outline-primary btn-sm">
        {{main_league.season}} - {{main_league.league_name}} - League Page</a>
    <br/>
    <a href="{{batter_url}}" target="_blank" class="btn btn-outline-primary btn-sm">Razzball Hitter Projections</a>
    <a href="{{pitcher_url}}" target="_blank" class="btn btn-outline-primary btn-sm">Razzball Pitcher Projections</a>
</div>

<div>
    <h2>Update Database Player Projections</h2>
    <a href="/projections/scrape_proj" class="btn btn-outline-primary btn-sm">Scrape Projections from Razzball</a>
    <p>
        {% if razzball_proj_update_datetime %}
        {% localtime off %}
        <strong>NEW PROJECTIONS AVAILABLE AS OF {{razzball_proj_update_datetime|date:'n.j.Y'}}</strong>
        {% endlocaltime %}
        {% else %}
        Projections are up to date
        {% endif %}
    </p>
    {% if error_message %}<p><strong>{{ error_message }}</strong></p>{% endif %}



    <!--<div class="custom-file">-->
    <!--<input type="file" class="custom-file-input" id="customFile">-->
    <!--<label class="custom-file-label" for="customFile">Choose file</label>-->
    <!--</div>-->

    <div>
        <form action="/projections/process_players/" method="post" enctype="multipart/form-data" encoding='multipart/form-data'>
            {% csrf_token %}
            <div class="form-group">
                <label for="csv">batter/pitcher csv file</label>
                <input type="file" class="form-control-file" id="csv" name="csv" />
            </div>

            <div class="form-check">
                <input class="form-check-input" type="radio" name="player_type" id="batter" value="batter" checked>
                <label class="form-check-label" for="batter"> Batter
                </label>
            </div>
            <div class="form-check">
                <input class="form-check-input" type="radio" name="player_type" id="pitcher" value="pitcher">
                <label class="form-check-label" for="pitcher"> Pitcher
                </label>
            </div>
            <button type="submit" class="btn btn-primary btn-sm">import</button>
        </form>
    </div>

    {% if elapsed %}
    <h6>Updated in {{elapsed|floatformat:2}} seconds</h6>
    {% endif %}
    <br/>
</div>

<div class="form-group">
    {% if error_message %}<p><strong>{{ error_message }}</strong></p>{% endif %}
    <form method="post" action="../../projections/trade_projection/">
        {% csrf_token %}
        <label for="setMainLeague">Set Main League</label>
        <select class="form-control" id="setMainLeague" name="league_key">
            {% for league in max_year_leagues %}
            <option value="{{league.league_key}}">{{league.league_name}} - {{league.season}}</option>
            {% endfor %}
        </select>
        <button type="submit" class="btn btn-primary btn-sm">set</button>
    </form>
</div>
{% endblock %}


